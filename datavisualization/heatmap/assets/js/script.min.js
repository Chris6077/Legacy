var json,data;$(document).ready(function(){AOS.init({disable:"mobile"})}),$(document).ready(()=>{let t=new XMLHttpRequest;t.open("GET","https://raw.githubusercontent.com/freeCodeCamp/ProjectReferenceData/master/global-temperature.json",!0),t.send(),t.onload=function(){json=JSON.parse(t.responseText),data=json.monthlyVariance,draw()},$(window).resize(()=>{draw()})});let draw=()=>{$(".tooltip").remove(),$("main")[0].innerHTML="";let t=70,e=90,a=30,r=70,n={h:12*document.documentElement.clientHeight/24,w:Math.ceil(3*data.length/12)},d=["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],i=15,o=30,l=["January","February","March","April","May","June","July","August","September","October","November","December"],s=d3.scaleBand().domain(data.reduce((t,e)=>(!t.includes(e.year)&&t.push(e.year),t),[])).range([0,n.w]),c=d3.scaleBand().domain(d3.range(1,13)).range([0,n.h]),m=d3.scaleQuantize().domain([d3.min(data,t=>t.variance+json.baseTemperature),d3.max(data,t=>t.variance+json.baseTemperature)]).range(d.reverse()),g=d3.select("main").append("svg").attr("id","svg-canvas").attr("height",t+n.h+e).attr("width",r+n.w+a),p=g.append("g").attr("height",n.h).attr("width",n.w).attr("transform",`translate(${r},${t})`),h=(p.append("g").call(d3.axisLeft(c).tickFormat((t,e)=>l[e])).attr("id","y-axis").attr("color","black"),p.append("g").call(d3.axisBottom(s).tickValues(s.domain().filter((t,e)=>!(e%10)))).attr("id","x-axis").attr("color","black").attr("transform",`translate(0,${n.h})`)),u=d3.select("body").append("div").attr("id","tooltip").attr("class","tooltip").attr("data-year",n.year).style("opacity",0);p.selectAll("rect").data(data).enter().append("rect").attr("data-month",t=>t.month-1).attr("data-year",t=>t.year).attr("data-temp",t=>t.variance).attr("class","cell").attr("x",t=>s(t.year)).attr("y",t=>c(t.month)).attr("height",document.documentElement.clientHeight/24).attr("width",3).attr("fill",t=>m(t.variance+json.baseTemperature)).on("mouseover",t=>{u.attr("data-year",t.year).transition().duration(100).style("opacity",.9),u.html((t=>`${t.year} - ${l[t.month-1]}</br>${d3.format(".1f")(t.variance+json.baseTemperature)}&deg;C</br>${d3.format(".1f")(t.variance)}&deg;C`)(t)).style("left",d3.event.pageX+10+"px").style("top",d3.event.pageY-80+"px")}).on("mouseout",()=>{u.transition().duration(300).style("opacity",0)});let y=g.append("text").attr("id","title").text("Monthly Global Land-Surface Temperature"),f=g.append("text").attr("id","description").html(`${d3.min(s.domain())}-${d3.max(s.domain())}, base temperature - ${json.baseTemperature}&deg;C`);y.attr("x",r+n.w/2-y.node().getBoundingClientRect().width/2).attr("y",y.node().getBoundingClientRect().height/2+20),f.attr("x",r+n.w/2-f.node().getBoundingClientRect().width/2).attr("y",y.node().getBoundingClientRect().height+f.node().getBoundingClientRect().height+10);let b=g.append("g").attr("id","legend");b.selectAll("rect").data(d).enter().append("rect").attr("x",(t,e)=>e*o).attr("height",i).attr("width",o).attr("fill",t=>t).attr("stroke","black");let w=d3.scaleLinear().domain(m.domain()).range([0,o*d.length]),x=m.range().reduce((t,e,a)=>{let r=m.invertExtent(e);return t.push(r[0]),a===m.range().length-1&&t.push(r[1]),t},[]),v=d3.axisBottom(w).tickFormat(d3.format(".1f")).tickValues(x);b.append("g").call(v).attr("id","lg-axis").attr("color","black").attr("transform",`translate(0,${i})`);let C=h.node().getBoundingClientRect().height;b.attr("transform",`translate(${r+(n.w-b.node().getBoundingClientRect().width)/2},${t+n.h+C+(e-C)/2-b.node().getBoundingClientRect().height/2})`);setTimeout(()=>{$("#preloader").fadeOut(500)},500);setTimeout(()=>{$("#preloader").remove()},1100);};