var json;$(document).ready(function(){AOS.init({disable:"mobile"})}),$(document).ready(()=>{let t=new XMLHttpRequest;t.open("GET","https://raw.githubusercontent.com/freeCodeCamp/ProjectReferenceData/master/cyclist-data.json",!0),t.send(),t.onload=function(){json=JSON.parse(t.responseText),draw()},$(window).resize(()=>{draw()})});let draw=()=>{$(".tooltip").remove(),$("main")[0].innerHTML="";let t=50,e=50,a=30,i=70,n={height:document.documentElement.clientHeight/2,width:700},r=d3.timeParse("%M:%S"),d=d3.timeParse("%Y"),o=json.map(t=>+t.Time.substring(0,2)).sort((t,e)=>t-e),l=d3.scaleTime().domain([d3.min(json,t=>d(t.Year-1)),d3.max(json,t=>d(t.Year+1))]).range([0,n.width]),s=d3.scaleTime().domain([r(`${o[0]}:00`),r(`${o[o.length-1]+1}:00`)]).range([0,n.height]),c=d3.select("main").append("svg").attr("id","svg-canvas").attr("height",t+n.height+e).attr("width",i+n.width+a),g=c.append("g").attr("height",n.height).attr("width",n.width).attr("transform",`translate(${i},${t})`),p=d3.select("body").append("div").attr("id","tooltip").attr("class","tooltip").style("opacity",0),m=c.append("text").attr("id","title").text("Doping in Professional Bicycle Racing (35 Fastest Times)");m.attr("x",i+n.width/2-m.node().getBoundingClientRect().width/2).attr("y",(t+m.node().getBoundingClientRect().height)/2),g.append("g").call(d3.axisBottom(l)).attr("id","x-axis").style("color","black").attr("transform",`translate(0,${n.height})`);let h=g.append("text").attr("id","label").attr("transform","rotate(-90)").text("Time in minutes"),y=g.append("g").call(d3.axisLeft(s).tickFormat(d3.timeFormat("%M:%S"))).attr("id","y-axis").style("color","black").node().getBoundingClientRect().width;h.attr("x",-(h.node().getBoundingClientRect().height+n.height)/2).attr("y",-y-(i-y)/4);let u=d3.scaleOrdinal(d3.schemeCategory10);g.selectAll("rect").data(json).enter().append("circle").attr("data-xvalue",t=>d(t.Year)).attr("data-yvalue",t=>r(t.Time)).attr("class","dot").attr("fill",t=>u(""===t.Doping)).style("stroke","black").attr("cx",t=>l(d(t.Year))).attr("cy",t=>s(r(t.Time))).attr("r",t=>t.Doping?4:8).on("mouseover",t=>{p.attr("data-year",d(t.Year)).transition().duration(100).style("opacity",.9),p.html((t=>`${t.Name} (${t.Nationality})</br>${t.Year} Place ${t.Place} in ${t.Time} min</br>${t.Doping}`)(t)).style("left",d3.event.pageX+a/2+"px").style("top",d3.event.pageY-e+"px")}).on("mouseout",()=>{p.transition().duration(300).style("opacity",0)});let w=2,x=2,f=2,b=15,v=15,R=g.append("svg").attr("id","legend"),T=R.selectAll(".legend-item").data(u.domain()).enter().append("g").attr("class","legend-item").attr("transform",(t,e)=>`translate(0,${(w+b+x)*e})`);T.append("rect").attr("width",v).attr("height",b).style("fill",u).style("stroke","black"),T.append("text").text(t=>t?"Riders without doping allegations":"Riders with doping allegations").attr("x",v+f).attr("y",b-3);T.node().getBoundingClientRect().height;let C=T.node().getBoundingClientRect().width;R.attr("transform",`translate(${(n.width-C)/2},${w})`)};